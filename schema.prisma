generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String?
  role      Role      @default(USER)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  books     Book[]
  comments  Comment[]
  movies    Movie[]
  posts     Post[]
  projects  Project[]
  snippets  Snippet[]
  commentReactions CommentReaction[]

  @@map("users")
}

model Post {
  id           String   @id @default(cuid())
  title        String
  slug         String   @unique
  summary      String?
  content      String
  date         DateTime @default(now())
  lastmod      DateTime @updatedAt
  tags         String[]
  categories   String[]
  images       String[]
  authors      String[]
  draft        Boolean  @default(true)
  featured     Boolean  @default(false)
  canonicalUrl String?
  layout       String?
  bibliography String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  authorId     String
  author       User     @relation(fields: [authorId], references: [id])

  @@map("posts")
}

model Project {
  id          String   @id @default(cuid())
  type        String   @default("self")
  title       String
  slug        String   @unique
  description String?
  imgSrc      String   @default("")
  url         String?
  repo        String?
  builtWith   String[] @default([])
  links       Json?
  content     String?
  date        DateTime @default(now())
  lastmod     DateTime @updatedAt
  draft       Boolean  @default(false)
  featured    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  authorId    String
  author      User     @relation(fields: [authorId], references: [id])

  @@map("projects")
}

model Snippet {
  id         String   @id @default(cuid())
  title      String
  slug       String   @unique
  summary    String?
  content    String
  date       DateTime @default(now())
  lastmod    DateTime @updatedAt
  tags       String[]
  categories String[]
  images     String[]
  authors    String[]
  draft      Boolean  @default(true)
  featured   Boolean  @default(false)
  layout     String?
  language   String?
  framework  String?
  difficulty String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  authorId   String
  author     User     @relation(fields: [authorId], references: [id])

  @@map("snippets")
}

model Movie {
  id         String   @id @default(cuid())
  title      String
  slug       String   @unique
  summary    String?
  content    String
  date       DateTime @default(now())
  lastmod    DateTime @updatedAt
  tags       String[]
  categories String[]
  images     String[]
  authors    String[]
  draft      Boolean  @default(true)
  featured   Boolean  @default(false)
  layout     String?
  director   String?
  year       Int?
  titleType  String?
  yourRating Int?
  imdbRating Float?
  imdbUrl    String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  authorId   String
  author     User     @relation(fields: [authorId], references: [id])

  @@map("movies")
}

model Book {
  id           String   @id @default(cuid())
  title        String
  slug         String   @unique
  summary      String?
  content      String
  date         DateTime @default(now())
  lastmod      DateTime @updatedAt
  tags         String[]
  categories   String[]
  images       String[]
  authors      String[]
  draft        Boolean  @default(true)
  featured     Boolean  @default(false)
  layout       String?
  bookAuthor   String?
  year         Int?
  pageCount    Int?
  userShelves  String?
  goodreadsUrl String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  authorId     String
  author       User     @relation(fields: [authorId], references: [id])

  @@map("books")
}

model Stats {
  type      StatsType
  slug      String
  views     Int       @default(0)
  loves     Int       @default(0)
  applauses Int       @default(0)
  ideas     Int       @default(0)
  bullseyes Int       @default(0)

  @@id([type, slug])
  @@map("stats")
}

model Product {
  id               String           @id @default(cuid())
  slug             String           @unique
  name             String
  description      String
  shortDescription String
  price            Float
  salePrice        Float?
  category         String
  tags             String[]
  images           String[]
  featured         Boolean          @default(false)
  inStock          Boolean          @default(true)
  stripeProductId  String?
  stripePriceId    String?
  specifications   Json?
  rating           Float?
  reviewCount      Int?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  variants         ProductVariant[]
  reviews          Review[]

  @@map("products")
}

model ProductVariant {
  id            String  @id @default(cuid())
  name          String
  price         Float
  stripePriceId String?
  attributes    Json
  inStock       Boolean @default(true)
  productId     String
  product       Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_variants")
}

model Review {
  id        String   @id @default(cuid())
  author    String
  rating    Int
  comment   String
  date      DateTime
  verified  Boolean  @default(false)
  productId String
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("reviews")
}

model GoodreadsBook {
  id                 String   @id
  guid               String
  pubDate            String
  title              String
  link               String
  bookImageUrl       String
  bookSmallImageUrl  String
  bookMediumImageUrl String
  bookLargeImageUrl  String
  bookDescription    String
  authorName         String
  isbn               String?
  userName           String
  userRating         Float
  userReadAt         String?
  userDateAdded      String
  userDateCreated    String
  userShelves        String?
  userReview         String?
  averageRating      Float
  bookPublished      String?
  numPages           Int?
  content            String
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("goodreads_books")
}

model GoodreadsMovie {
  id            String   @id
  yourRating    Float
  dateRated     String
  title         String
  originalTitle String
  url           String
  titleType     String
  imdbRating    Float
  runtime       Float
  year          String?
  genres        String
  numVotes      Float
  releaseDate   String
  directors     String
  actors        String
  plot          String
  poster        String
  language      String
  country       String
  awards        String
  boxOffice     String?
  totalSeasons  String?
  ratings       Json
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("goodreads_movies")
}

model CaptainsLog {
  id               String   @id @default(cuid())
  timestamp        DateTime @default(now())
  transcription    String
  summary          String?
  contentType      String
  tags             String[]
  blogPotential    Boolean  @default(false)
  projectPotential Boolean  @default(false)
  duration         Int?
  isPrivate        Boolean  @default(true)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@map("captains_logs")
}

model SiteSettings {
  id                 String   @id @default("default")
  title              String   @default("Dana's dev blog â€“ stories, insights, and ideas")
  author             String   @default("Dana Davis")
  headerTitle        String   @default("Dana's dev blog")
  description        String   @default("A personal space on the cloud where I document my programming journey, sharing lessons, insights, and resources for fellow developers.")
  language           String   @default("en-us")
  locale             String   @default("en-US")
  siteUrl            String   @default("https://danadavis.dev")
  siteRepo           String   @default("https://github.com/xi-Rick/danadavis.dev")
  siteLogo           String   @default("/static/images/logo.png")
  socialBanner       String   @default("/static/images/twitter-card.jpeg")
  faviconPath        String   @default("/favicon.ico")
  email              String   @default("dana@danadavis.dev")
  github             String   @default("https://github.com/xi-Rick")
  x                  String   @default("https://twitter.com/cortrale")
  youtube            String   @default("https://youtube.com/@danadavisyt")
  linkedin           String   @default("https://www.linkedin.com/in/danadavisdev/")
  threads            String   @default("https://www.threads.net/cortrale")
  instagram          String   @default("https://www.instagram.com/cortrale")
  buyMeACoffee       String   @default("https://www.buymeacoffee.com/danadavis")
  paypal             String?
  kofi               String   @default("https://ko-fi.com/danadavisdev")
  goodreadsBookshelf String?
  imdbRatingsList    String?
  umamiWebsiteId     String?
  umamiShareUrl      String?
  disqusShortname    String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("site_settings")
}

model Comment {
  id          String    @id @default(cuid())
  postSlug    String
  parentId    String?
  content     String
  authorName  String?
  authorEmail String?
  authorImage String?
  isDeleted   Boolean   @default(false)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  authorId    String?
  author      User?     @relation(fields: [authorId], references: [id])
  parent      Comment?  @relation("CommentChildren", fields: [parentId], references: [id])
  replies     Comment[] @relation("CommentChildren")
  reactions   CommentReaction[]

  @@map("comments")
}

model CommentReaction {
  id        String   @id @default(cuid())
  commentId String
  userId    String
  createdAt DateTime @default(now())
  comment   Comment  @relation(fields: [commentId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, userId])
  @@map("comment_reactions")
}

enum Role {
  USER
  ADMIN
}

enum StatsType {
  blog
  snippet
}

model ShopItem {
  id          String        @id @default(cuid())
  title       String
  slug        String        @unique
  target      Float?
  contributed Float         @default(0)
  currency    String        @default("USD")
  summary     String
  description String
  images      String[]
  featured    Boolean       @default(false)
  active      Boolean       @default(true)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  contributions Contribution[]

  @@map("shop_items")
}

model Contribution {
  id             String   @id @default(cuid())
  shopItemId     String
  amount         Float
  currency       String   @default("USD")
  stripeSessionId String? @unique
  email          String?
  createdAt      DateTime @default(now())
  shopItem       ShopItem @relation(fields: [shopItemId], references: [id], onDelete: Cascade)

  @@map("contributions")
}
